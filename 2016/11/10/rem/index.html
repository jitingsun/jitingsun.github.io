<!DOCTYPE html>


  <html class="dark page-post">


<head>
  <meta charset="utf-8">
  
  <title>rem | My Blog</title>

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
    <meta name="keywords" content="天逸风,前端,设计,Hexo主题,前端开发,用户体验,设计,frontend,design,nodejs,JavaScript" />
  

  <meta name="description" content="了解REM手机屏幕适配rem 作为一个低调的长度单位，由于手机端网页的兴起，在屏幕适配中得到重用。使用 rem 前端开发者可以很方便的在各种屏幕尺寸下，通过等比缩放的方式达到设计图要求的效果。
rem 的官方定义『The font size of the root element.』，即以根节点的字体大小作为基准值进行长度计算。一般认为网页中的根节点是 html 元素，所以采用的方式也是通过设置">
<meta property="og:type" content="article">
<meta property="og:title" content="rem">
<meta property="og:url" content="http://yoursite.com/2016/11/10/rem/index.html">
<meta property="og:site_name" content="My Blog">
<meta property="og:description" content="了解REM手机屏幕适配rem 作为一个低调的长度单位，由于手机端网页的兴起，在屏幕适配中得到重用。使用 rem 前端开发者可以很方便的在各种屏幕尺寸下，通过等比缩放的方式达到设计图要求的效果。
rem 的官方定义『The font size of the root element.』，即以根节点的字体大小作为基准值进行长度计算。一般认为网页中的根节点是 html 元素，所以采用的方式也是通过设置">
<meta property="og:image" content="http://yoursite.com/./images/scheme3.1.jpeg">
<meta property="og:image" content="http://yoursite.com/./images/scheme4.1.jpeg">
<meta property="og:image" content="http://yoursite.com/./images/scheme3.2.jpeg">
<meta property="og:image" content="http://yoursite.com/./images/scheme4.2.jpeg">
<meta property="og:image" content="http://yoursite.com/./images/scheme4-1.1.jpeg">
<meta property="og:image" content="http://yoursite.com/./images/scheme4-1.2.jpeg">
<meta property="og:image" content="http://yoursite.com/./images/scheme4-2.1.jpeg">
<meta property="og:image" content="http://yoursite.com/./images/scheme4-2.2.jpeg">
<meta property="og:updated_time" content="2016-11-22T08:16:55.752Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="rem">
<meta name="twitter:description" content="了解REM手机屏幕适配rem 作为一个低调的长度单位，由于手机端网页的兴起，在屏幕适配中得到重用。使用 rem 前端开发者可以很方便的在各种屏幕尺寸下，通过等比缩放的方式达到设计图要求的效果。
rem 的官方定义『The font size of the root element.』，即以根节点的字体大小作为基准值进行长度计算。一般认为网页中的根节点是 html 元素，所以采用的方式也是通过设置">
<meta name="twitter:image" content="http://yoursite.com/./images/scheme3.1.jpeg">

  

  
    <link rel="icon" href="/favicon.ico">
  

  <link href="/css/styles.css?v=028c63b1" rel="stylesheet">


  
    <link rel="stylesheet" href="/css/personal-style.css">
  

  

  
  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?57e94d016e201fba3603a8a2b0263af0";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>


</head>

<body>


  
    <span id="toolbox-mobile" class="toolbox-mobile">盒子</span>
  

  <div class="post-header CENTER">
   
  <div class="toolbox">
    <a class="toolbox-entry" href="/">
      <span class="toolbox-entry-text">盒子</span>
      <i class="icon-angle-down"></i>
      <i class="icon-home"></i>
    </a>
    <ul class="list-toolbox">
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/archives/"
            rel="noopener noreferrer"
            target="_self"
            >
            博客
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/about/"
            rel="noopener noreferrer"
            target="_self"
            >
            关于
          </a>
        </li>
      
        <li class="item-toolbox">
          <a
            class="CIRCLE"
            href="/search/"
            rel="noopener noreferrer"
            target="_self"
            >
            搜索
          </a>
        </li>
      
    </ul>
  </div>


</div>


  <div id="toc" class="toc-article">
    <strong class="toc-title">文章目录</strong>
    <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#了解REM手机屏幕适配"><span class="toc-text">了解REM手机屏幕适配</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#方案1"><span class="toc-text">方案1</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#方案2"><span class="toc-text">方案2</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#方案3"><span class="toc-text">方案3</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#方案4"><span class="toc-text">方案4</span></a></li></ol></li></ol></li></ol></li></ol>
  </div>



<div class="content content-post CENTER">
   <article id="post-rem" class="article article-type-post" itemprop="blogPost">
  <header class="article-header">
    <h1 class="post-title">rem</h1>

    <div class="article-meta">
      <span>
        <i class="icon-calendar"></i>
        <span>2016.11.10</span>
      </span>

      
        <span class="article-author">
          <i class="icon-user"></i>
          <span>天逸风</span>
        </span>
      

      


      

    </div>
  </header>

  <div class="article-content">
    
      <h1 id="了解REM手机屏幕适配"><a href="#了解REM手机屏幕适配" class="headerlink" title="了解REM手机屏幕适配"></a>了解REM手机屏幕适配</h1><p><code>rem</code> 作为一个低调的长度单位，由于手机端网页的兴起，在屏幕适配中得到重用。使用 <code>rem</code> 前端开发者可以很方便的在各种屏幕尺寸下，通过<code>等比缩放</code>的方式达到设计图要求的效果。<br></p>
<p><code>rem</code> 的官方定义『The font size of the root element.』，即以根节点的字体大小作为基准值进行长度计算。一般认为网页中的根节点是 <code>html</code> 元素，所以采用的方式也是通过设置 <code>html</code> 元素的 <code>font-size</code> 来做屏幕适配，但实际情况真有这么简单吗？</p>
<p>首先我们来看看使用 <code>rem</code> 实现手机屏幕适配的常用方案。<br></p>
<p>以设计稿的宽度为<code>640px</code>，即：<code>designWidth = 640</code>，同时设定在640px屏宽下 <code>1rem=100px</code> ，即：<code>rem2px = 100</code>。</p>
<blockquote>
<p>设置 <code>1rem=100px</code> 的优点不言而喻。前端开发者在切图、重构页面的时候，通过直接位移小数点的方式，就可以将UI图中测量到的 <code>px</code> 值换算成对应的 <code>rem</code> 值，方便快捷。</p>
<p>此外，在 <code>head</code> 中我们还设置了：<code>&lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0&quot; /&gt;</code> <br><br><code>viewport</code> 的作用很重要，但不是本文的重点所以不展开，有兴趣的同学可以自行搜索。</p>
</blockquote>
<p>先来看看具体方案：</p>
<blockquote>
<p>下面四个方案来自同事共享，原理都是采用等比缩放的方式 —— 获得目标屏幕宽度和设计稿宽度的比，作为 <code>rem</code> 的基值（缩放系数），设置为<code>html</code>标签的字体大小。不同的只是在于性能取舍和书写习惯。</p>
</blockquote>
<h4 id="方案1"><a href="#方案1" class="headerlink" title="方案1"></a>方案1</h4><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">@<span class="keyword">media</span> screen and (min-width: <span class="number">320px</span>) &#123;<span class="selector-tag">html</span>&#123;<span class="attribute">font-size</span>:<span class="number">50px</span>;&#125;&#125;</div><div class="line">@<span class="keyword">media</span> screen and (min-width: <span class="number">360px</span>) &#123;<span class="selector-tag">html</span>&#123;<span class="attribute">font-size</span>:<span class="number">56.25px</span>;&#125;&#125;</div><div class="line">@<span class="keyword">media</span> screen and (min-width: <span class="number">375px</span>) &#123;<span class="selector-tag">html</span>&#123;<span class="attribute">font-size</span>:<span class="number">58.59375px</span>;&#125;&#125;</div><div class="line">@<span class="keyword">media</span> screen and (min-width: <span class="number">400px</span>) &#123;<span class="selector-tag">html</span>&#123;<span class="attribute">font-size</span>:<span class="number">62.5px</span>;&#125;&#125;</div><div class="line">@<span class="keyword">media</span> screen and (min-width: <span class="number">414px</span>) &#123;<span class="selector-tag">html</span>&#123;<span class="attribute">font-size</span>:<span class="number">64.6875px</span>;&#125;&#125;</div><div class="line">@<span class="keyword">media</span> screen and (min-width: <span class="number">440px</span>) &#123;<span class="selector-tag">html</span>&#123;<span class="attribute">font-size</span>:<span class="number">68.75px</span>;&#125;&#125;</div><div class="line">@<span class="keyword">media</span> screen and (min-width: <span class="number">480px</span>) &#123;<span class="selector-tag">html</span>&#123;<span class="attribute">font-size</span>:<span class="number">75px</span>;&#125;&#125;</div><div class="line">@<span class="keyword">media</span> screen and (min-width: <span class="number">520px</span>) &#123;<span class="selector-tag">html</span>&#123;<span class="attribute">font-size</span>:<span class="number">81.25px</span>;&#125;&#125;</div><div class="line">@<span class="keyword">media</span> screen and (min-width: <span class="number">560px</span>) &#123;<span class="selector-tag">html</span>&#123;<span class="attribute">font-size</span>:<span class="number">87.5px</span>;&#125;&#125;</div><div class="line">@<span class="keyword">media</span> screen and (min-width: <span class="number">600px</span>) &#123;<span class="selector-tag">html</span>&#123;<span class="attribute">font-size</span>:<span class="number">93.75px</span>;&#125;&#125;</div><div class="line">@<span class="keyword">media</span> screen and (min-width: <span class="number">640px</span>) &#123;<span class="selector-tag">html</span>&#123;<span class="attribute">font-size</span>:<span class="number">100px</span>;&#125;&#125;</div><div class="line">@<span class="keyword">media</span> screen and (min-width: <span class="number">680px</span>) &#123;<span class="selector-tag">html</span>&#123;<span class="attribute">font-size</span>:<span class="number">106.25px</span>;&#125;&#125;</div><div class="line">@<span class="keyword">media</span> screen and (min-width: <span class="number">720px</span>) &#123;<span class="selector-tag">html</span>&#123;<span class="attribute">font-size</span>:<span class="number">112.5px</span>;&#125;&#125;</div><div class="line">@<span class="keyword">media</span> screen and (min-width: <span class="number">760px</span>) &#123;<span class="selector-tag">html</span>&#123;<span class="attribute">font-size</span>:<span class="number">118.75px</span>;&#125;&#125;</div><div class="line">@<span class="keyword">media</span> screen and (min-width: <span class="number">800px</span>) &#123;<span class="selector-tag">html</span>&#123;<span class="attribute">font-size</span>:<span class="number">125px</span>;&#125;&#125;</div><div class="line">@<span class="keyword">media</span> screen and (min-width: <span class="number">960px</span>) &#123;<span class="selector-tag">html</span>&#123;<span class="attribute">font-size</span>:<span class="number">150px</span>;&#125;&#125;</div></pre></td></tr></table></figure>
<h4 id="方案2"><a href="#方案2" class="headerlink" title="方案2"></a>方案2</h4><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">@<span class="keyword">media</span> screen and (min-width: <span class="number">320px</span>) &#123;<span class="selector-tag">html</span>&#123;<span class="attribute">font-size</span>:<span class="number">312.5%</span>;&#125;&#125;</div><div class="line">@<span class="keyword">media</span> screen and (min-width: <span class="number">360px</span>) &#123;<span class="selector-tag">html</span>&#123;<span class="attribute">font-size</span>:<span class="number">351.5625%</span>;&#125;&#125;</div><div class="line">@<span class="keyword">media</span> screen and (min-width: <span class="number">375px</span>) &#123;<span class="selector-tag">html</span>&#123;<span class="attribute">font-size</span>:<span class="number">366.211%</span>;&#125;&#125;</div><div class="line">@<span class="keyword">media</span> screen and (min-width: <span class="number">400px</span>) &#123;<span class="selector-tag">html</span>&#123;<span class="attribute">font-size</span>:<span class="number">390.625%</span>;&#125;&#125;</div><div class="line">@<span class="keyword">media</span> screen and (min-width: <span class="number">414px</span>) &#123;<span class="selector-tag">html</span>&#123;<span class="attribute">font-size</span>:<span class="number">404.2969%</span>;&#125;&#125;</div><div class="line">@<span class="keyword">media</span> screen and (min-width: <span class="number">440px</span>) &#123;<span class="selector-tag">html</span>&#123;<span class="attribute">font-size</span>:<span class="number">429.6875%</span>;&#125;&#125;</div><div class="line">@<span class="keyword">media</span> screen and (min-width: <span class="number">480px</span>) &#123;<span class="selector-tag">html</span>&#123;<span class="attribute">font-size</span>:<span class="number">468.75%</span>;&#125;&#125;</div><div class="line">@<span class="keyword">media</span> screen and (min-width: <span class="number">520px</span>) &#123;<span class="selector-tag">html</span>&#123;<span class="attribute">font-size</span>:<span class="number">507.8125%</span>;&#125;&#125;</div><div class="line">@<span class="keyword">media</span> screen and (min-width: <span class="number">560px</span>) &#123;<span class="selector-tag">html</span>&#123;<span class="attribute">font-size</span>:<span class="number">546.875%</span>;&#125;&#125;</div><div class="line">@<span class="keyword">media</span> screen and (min-width: <span class="number">600px</span>) &#123;<span class="selector-tag">html</span>&#123;<span class="attribute">font-size</span>:<span class="number">585.9375%</span>;&#125;&#125;</div><div class="line">@<span class="keyword">media</span> screen and (min-width: <span class="number">640px</span>) &#123;<span class="selector-tag">html</span>&#123;<span class="attribute">font-size</span>:<span class="number">625%</span>;&#125;&#125;</div><div class="line">@<span class="keyword">media</span> screen and (min-width: <span class="number">680px</span>) &#123;<span class="selector-tag">html</span>&#123;<span class="attribute">font-size</span>:<span class="number">664.0625%</span>;&#125;&#125;</div><div class="line">@<span class="keyword">media</span> screen and (min-width: <span class="number">720px</span>) &#123;<span class="selector-tag">html</span>&#123;<span class="attribute">font-size</span>:<span class="number">703.125%</span>;&#125;&#125;</div><div class="line">@<span class="keyword">media</span> screen and (min-width: <span class="number">760px</span>) &#123;<span class="selector-tag">html</span>&#123;<span class="attribute">font-size</span>:<span class="number">742.1875%</span>;&#125;&#125;</div><div class="line">@<span class="keyword">media</span> screen and (min-width: <span class="number">800px</span>) &#123;<span class="selector-tag">html</span>&#123;<span class="attribute">font-size</span>:<span class="number">781.25%</span>;&#125;&#125;</div><div class="line">@<span class="keyword">media</span> screen and (min-width: <span class="number">960px</span>) &#123;<span class="selector-tag">html</span>&#123;<span class="attribute">font-size</span>:<span class="number">937.5%</span>;&#125;&#125;</div></pre></td></tr></table></figure>
<h4 id="方案3"><a href="#方案3" class="headerlink" title="方案3"></a>方案3</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> designWidth = <span class="number">640</span>, rem2px = <span class="number">100</span>;</div><div class="line"><span class="built_in">document</span>.documentElement.style.fontSize = </div><div class="line">  ((<span class="built_in">window</span>.innerWidth / designWidth) * rem2px) + <span class="string">'px'</span>;</div></pre></td></tr></table></figure>
<h4 id="方案4"><a href="#方案4" class="headerlink" title="方案4"></a>方案4</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> designWidth = <span class="number">640</span>, rem2px = <span class="number">100</span>;</div><div class="line"><span class="built_in">document</span>.documentElement.style.fontSize = </div><div class="line">  ((((<span class="built_in">window</span>.innerWidth / designWidth) * rem2px) / <span class="number">16</span>) * <span class="number">100</span>) + <span class="string">'%'</span>;</div></pre></td></tr></table></figure>
<blockquote>
<p>为了更避免理解上的混乱，我在上面js的代码中加了 <code>(</code> <code>)</code> ，实际代码中是不需要的。</p>
</blockquote>
<p>详细分析一下，<code>rem</code> 和 <code>px</code> 直接的转换公式可以写为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">1rem = 1 * htmlFontSize</div></pre></td></tr></table></figure>
<blockquote>
<p><code>htmlFontSize</code> 为 <code>html</code> 元素的字体大小。</p>
</blockquote>
<p>首先来看方案1中，在屏宽为<code>640px</code>情况下的设置：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">@<span class="keyword">media</span> screen and (min-width: <span class="number">640px</span>) &#123;<span class="selector-tag">html</span>&#123;<span class="attribute">font-size</span>:<span class="number">100px</span>;&#125;&#125;</div></pre></td></tr></table></figure>
<p>可以很明显的表现出这一点 <code>1rem = 1 * 100px</code> ，同我们最初的设定。那么我们要得到其它屏幕大小的 <code>htmlFontSize</code> 值要怎么办。很简单如方案3，因为我们的采用等比缩放的方式适配，所以计算目标屏幕宽度和设计稿的宽度的比即可：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">window</span>.innerWidth / designWidth * rem2px + <span class="string">'px'</span></div></pre></td></tr></table></figure>
<p>由于浏览器默认字体大小为 <code>16px</code>，所以当我们使用百分比作为根节点 <code>html</code> 的字体大小时，即<code>html</code>元素的<code>font-size</code>值设置为一个百分比值，<code>rem</code> 的计算方式就会改为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">defaultFontSize = 16px</div><div class="line">1rem = 1 * htmlFontSize * defaultFontSize</div></pre></td></tr></table></figure>
<p>如方案2中，在屏宽为<code>640px</code>情况下的设置：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">@<span class="keyword">media</span> screen and (min-width: <span class="number">640px</span>) &#123;<span class="selector-tag">html</span>&#123;<span class="attribute">font-size</span>:<span class="number">625%</span>;&#125;&#125;</div></pre></td></tr></table></figure>
<p>应用上面的公式：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">1rem = 1 * 625% * 16px</div><div class="line">其中：625% * 16 = 6.25 * 16 = 100</div><div class="line">所以：1rem = 1 * 100px</div></pre></td></tr></table></figure>
<p>同样的可以得到所有屏幕大小下，<code>html</code> 的 <code>font-size</code> 值的计算公式，即为方案4：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">window</span>.innerWidth / designWidth * rem2px / <span class="number">16</span> * <span class="number">100</span>  + <span class="string">'%'</span></div></pre></td></tr></table></figure>
<p>通过方案3和方案4的公式，就可以很方便的生成方案1和方案2中的css。<br></p>
<p>这里只给出了方案3和方案4对应验证页面（方案1和方案2是它们的变形）: <a href="http://htmlpreview.github.io/?https://github.com/hbxeagle/rem/blob/master/scheme3.html" target="_blank" rel="external">scheme3.html</a>, <a href="http://htmlpreview.github.io/?https://github.com/hbxeagle/rem/blob/master/scheme4.html" target="_blank" rel="external">scheme4.html</a><br></p>
<blockquote>
<p>如下面两张图，是在屏宽为360px下的效果，通过计算目标为：<code>1rem = 56.25px</code>。方案3设置值为：<code>56.25px</code>，方案4设置值为：<code>351.5625%</code></p>
</blockquote>
<table>
<thead>
<tr>
<th>方案3</th>
<th>方案4</th>
</tr>
</thead>
<tbody>
<tr>
<td><img src="./images/scheme3.1.jpeg" alt=""></td>
<td><img src="./images/scheme4.1.jpeg" alt=""></td>
</tr>
</tbody>
</table>
<p>到目前为止貌似很完美的解决了问题，实际情况当然是出现了意外。在有些 Android 手机上，浏览器或 webview 的默认字体是随着系统设置的字体改变的。这样就会导致默认字体大于或小于 <code>16px</code>。<br></p>
<p>修改默认字体大小后，我们再看方案3和方案4。<br></p>
<p>同样在屏宽为360px下，我们调大系统字体大小，如下面的效果<br></p>
<blockquote>
<p>设置前 <code>html</code> 元素的字体大小的<code>计算值</code>为 <code>18px</code> ，设置后的<code>计算值</code>为 <code>65px</code> ，由于屏幕宽度没有改变，我们的目标值，即我们在 <code>html</code> 元素上设置的 <code>font-size</code> 值也没有变化任然为 <code>56.25px</code>，而最终<code>计算值</code>出现了偏差。</p>
</blockquote>
<table>
<thead>
<tr>
<th>方案3</th>
<th>方案4</th>
</tr>
</thead>
<tbody>
<tr>
<td><img src="./images/scheme3.2.jpeg" alt=""></td>
<td><img src="./images/scheme4.2.jpeg" alt=""></td>
</tr>
</tbody>
</table>
<p>分析偏差前，先来看在<code>360px</code>屏宽下，方案3和方案4的计算过程：<br></p>
<p>方案3：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">document.documentElement.style.fontSize = 56.25px</div><div class="line">htmlFontSize = 56.25px</div><div class="line">1rem = 1 * htmlFontSize = 56.25px</div><div class="line">实际为：</div><div class="line">1rem = 64.6875px</div></pre></td></tr></table></figure>
<p>方案4：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">document.documentElement.style.fontSize = 351.5625%</div><div class="line">htmlFontSize = 351.5625%</div><div class="line">defaultFontSize = 18px</div><div class="line">1rem = 1 * htmlFontSize * defaultFontSize = 351.5625% * 18px = 63.28125px</div><div class="line">351.5625% * 18 = 63.28125</div><div class="line">实际为：</div><div class="line">1rem = 64.6875px</div></pre></td></tr></table></figure>
<p>貌似方案4的计算结果很接近实际效果，而方案3偏差很大。再来比较方案3和方案4的计算公式：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 方案3</span></div><div class="line"><span class="built_in">document</span>.documentElement.style.fontSize = </div><div class="line">  <span class="built_in">window</span>.innerWidth / designWidth * rem2px + <span class="string">'px'</span>;</div><div class="line"></div><div class="line"><span class="comment">// 方案4</span></div><div class="line"><span class="built_in">document</span>.documentElement.style.fontSize = </div><div class="line">  <span class="built_in">window</span>.innerWidth / designWidth * rem2px / <span class="number">16</span> * <span class="number">100</span> + <span class="string">'%'</span>;</div></pre></td></tr></table></figure>
<p>方案4较于方案3其实多除了一个16，可以推测浏览器在计算 <code>rem</code> 的具体值时，如果 <code>html</code> 设置的 <code>font-size</code> 为 <code>px</code> 值时会先除以 <code>16</code> ，然后再乘以 <code>htmlFontSize</code>。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">1rem = 1 * (56.25px / 16) * 18</div><div class="line">1 * (56.25 / 16) * 18 = 63.28125</div></pre></td></tr></table></figure>
<p>方案4存在问题，是因为系统的默认字体改为了 <code>18px</code> ，但是我们在计算百分比是时候，还是以 <code>16px</code> 为基准值进行计算，所以出现偏差（计算值和实际值之间还有一点偏差这个在后面会提到）。</p>
<p>而在方案3中，我们其实是不考虑浏览器默认字体大小的，但在实际使用的过程中，浏览器还是除了 <code>16</code> ，而此时默认字体大小为 <code>18px</code>。得出如下在 <code>html</code> 的 <code>fontSize</code> 设置为 <code>px</code> 的情况下 <code>rem</code> 的计算公式为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">1rem = 1 * (htmlFontSize / 16) * defaultFontSize</div></pre></td></tr></table></figure>
<p>在系统设置的字体大小发生改变时，<code>defaultFontSize</code> 会跟着改变，而 <code>16</code> 不会变化。所以方案3虽然表面上不考虑默认字体大小的变化，只关注屏幕与设计稿之间的宽度比，但在实际计算中还是使用到了默认字体大小，而且还有一个不变的 <code>16</code> 在作祟，导致方案3失败。</p>
<blockquote>
<p>所谓的「<code>root element</code>」其实不是想象的那样，一个是<code>16</code>，一个是<code>18</code>，到底取的是那个 <code>root element</code> 的字体大小。<br></p>
</blockquote>
<p>ok，<code>rem</code> 的计算的时候，<code>px</code> 的方式会有一个<code>16</code>不随系统字体大小改变，所以我们采用百分比的方案，绕开这个问题。<br></p>
<p>采用百分比的<code>方案4</code>因为在计算时写死了默认字体大小 <code>16px</code>。所以它的偏差在于没能动态的获取默认字体大小。更新如下：<br></p>
<p>方案4.1</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> designWidth = <span class="number">640</span>, rem2px = <span class="number">100</span>;</div><div class="line"><span class="keyword">var</span> h = <span class="built_in">document</span>.getElementsByTagName(<span class="string">'html'</span>)[<span class="number">0</span>];</div><div class="line"><span class="keyword">var</span> htmlFontSize = <span class="built_in">parseFloat</span>(<span class="built_in">window</span>.getComputedStyle(h, <span class="literal">null</span>)</div><div class="line">                                    .getPropertyValue(<span class="string">'font-size'</span>));</div><div class="line"></div><div class="line"><span class="built_in">document</span>.documentElement.style.fontSize = </div><div class="line">  <span class="built_in">window</span>.innerWidth / designWidth * rem2px / htmlFontSize * <span class="number">100</span> + <span class="string">'%'</span>;</div></pre></td></tr></table></figure>
<p>效果如下图：</p>
<blockquote>
<p><code>16px</code> 的图中，设置后的 <code>html</code> 的 <code>font-size</code> 与 <code>1rem</code> 的实际值有偏差，同时 <code>6.4rem</code> 的计算值也有偏差。通过查看代码发现<code>html</code>的<code>font-size</code>使用的是： <code>getPropertyValue(&#39;font-size&#39;)</code> 而 <code>1rem</code> 使用的是 <code>getPropertyValue(&#39;width&#39;)</code>，偏差出在计算 <code>font-size</code> 的时候浏览器进行了四舍五入。<code>rem</code> 定义中的另一个元素「<code>font size</code>」也不能按字面意思使用，宣告失守。</p>
<p><code>18px</code> 中的偏差，以及上文中方案4在 <code>18px</code> 实际值和计算值出现的偏差都是同样的问题。所以基准值还需要修改。</p>
</blockquote>
<table>
<thead>
<tr>
<th>16px</th>
<th>18px</th>
</tr>
</thead>
<tbody>
<tr>
<td><img src="./images/scheme4-1.1.jpeg" alt=""></td>
<td><img src="./images/scheme4-1.2.jpeg" alt=""></td>
</tr>
</tbody>
</table>
<p>在更新一版，方案4.2：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> designWidth = <span class="number">640</span>, rem2px = <span class="number">100</span>;</div><div class="line"><span class="keyword">var</span> d = <span class="built_in">window</span>.document.createElement(<span class="string">'div'</span>);</div><div class="line">d.style.width = <span class="string">'1rem'</span>;</div><div class="line">d.style.display = <span class="string">"none"</span>;</div><div class="line"><span class="keyword">var</span> head = <span class="built_in">window</span>.document.getElementsByTagName(<span class="string">'head'</span>)[<span class="number">0</span>];</div><div class="line">head.appendChild(d);</div><div class="line"><span class="keyword">var</span> defaultFontSize = <span class="built_in">parseFloat</span>(<span class="built_in">window</span>.getComputedStyle(d, <span class="literal">null</span>).getPropertyValue(<span class="string">'width'</span>));</div><div class="line">d.remove();</div><div class="line"><span class="built_in">document</span>.documentElement.style.fontSize = </div><div class="line">  <span class="built_in">window</span>.innerWidth / designWidth * rem2px / defaultFontSize * <span class="number">100</span> + <span class="string">'%'</span>;</div></pre></td></tr></table></figure>
<p>效果如下图：</p>
<table>
<thead>
<tr>
<th>16px</th>
<th>18px</th>
</tr>
</thead>
<tbody>
<tr>
<td><img src="./images/scheme4-2.1.jpeg" alt=""></td>
<td><img src="./images/scheme4-2.2.jpeg" alt=""></td>
</tr>
</tbody>
</table>
<p>到此为止，<code>rem</code> 在默认字体不是 <code>16px</code> 的情况下的处理已经解决，考虑到还有设计屏幕旋转，最终手机端的解决方案为：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">adapt</span>(<span class="params">designWidth, rem2px</span>)</span>&#123;</div><div class="line">  <span class="keyword">var</span> d = <span class="built_in">window</span>.document.createElement(<span class="string">'div'</span>);</div><div class="line">  d.style.width = <span class="string">'1rem'</span>;</div><div class="line">  d.style.display = <span class="string">"none"</span>;</div><div class="line">  <span class="keyword">var</span> head = <span class="built_in">window</span>.document.getElementsByTagName(<span class="string">'head'</span>)[<span class="number">0</span>];</div><div class="line">  head.appendChild(d);</div><div class="line">  <span class="keyword">var</span> defaultFontSize = <span class="built_in">parseFloat</span>(<span class="built_in">window</span>.getComputedStyle(d, <span class="literal">null</span>).getPropertyValue(<span class="string">'width'</span>));</div><div class="line">  d.remove();</div><div class="line">  <span class="built_in">document</span>.documentElement.style.fontSize = <span class="built_in">window</span>.innerWidth / designWidth * rem2px / defaultFontSize * <span class="number">100</span> + <span class="string">'%'</span>;</div><div class="line">  <span class="keyword">var</span> st = <span class="built_in">document</span>.createElement(<span class="string">'style'</span>);</div><div class="line">  <span class="keyword">var</span> portrait = <span class="string">"@media screen and (min-width: "</span>+<span class="built_in">window</span>.innerWidth+<span class="string">"px) &#123;html&#123;font-size:"</span>+ ((<span class="built_in">window</span>.innerWidth/(designWidth/rem2px)/defaultFontSize)*<span class="number">100</span>) +<span class="string">"%;&#125;&#125;"</span>;</div><div class="line">  <span class="keyword">var</span> landscape = <span class="string">"@media screen and (min-width: "</span>+<span class="built_in">window</span>.innerHeight+<span class="string">"px) &#123;html&#123;font-size:"</span>+ ((<span class="built_in">window</span>.innerHeight/(designWidth/rem2px)/defaultFontSize)*<span class="number">100</span>) +<span class="string">"%;&#125;&#125;"</span></div><div class="line">  st.innerHTML = portrait + landscape;</div><div class="line">  head.appendChild(st);</div><div class="line">  <span class="keyword">return</span> defaultFontSize</div><div class="line">&#125;;</div><div class="line"><span class="keyword">var</span> defaultFontSize = adapt(<span class="number">640</span>, <span class="number">100</span>);</div></pre></td></tr></table></figure>
<p>回过头来再看 <code>rem</code> 的定义，『The font size of the root element.』。我们以为的 <code>root element</code> —— <code>html</code> 其实还有个影子在作祟，而我们以为的 <code>font-size</code> 其实是个近似值。</p>

    
  </div>
</article>

</div>





  <a id="backTop" class="back-top">
    <i class="icon-angle-up"></i>
  </a>




  <div class="modal" id="modal">
  <span id="cover" class="cover hide"></span>
  <div id="modal-dialog" class="modal-dialog hide-dialog">
    <div class="modal-header">
      <span id="close" class="btn-close">关闭</span>
    </div>
    <hr>
    <div class="modal-body">
      <ul class="list-toolbox">
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/archives/"
              rel="noopener noreferrer"
              target="_self"
              >
              博客
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/about/"
              rel="noopener noreferrer"
              target="_self"
              >
              关于
            </a>
          </li>
        
          <li class="item-toolbox">
            <a
              class="CIRCLE"
              href="/search/"
              rel="noopener noreferrer"
              target="_self"
              >
              搜索
            </a>
          </li>
        
      </ul>

    </div>
  </div>
</div>



  
      <div class="fexo-comments comments-post">
    

    




  </div>

  

  <script type="text/javascript">
  function loadScript(url, callback) {
    var script = document.createElement('script')
    script.type = 'text/javascript';

    if (script.readyState) { //IE
      script.onreadystatechange = function() {
        if (script.readyState == 'loaded' ||
          script.readyState == 'complete') {
          script.onreadystatechange = null;
          callback();
        }
      };
    } else { //Others
      script.onload = function() {
        callback();
      };
    }

    script.src = url;
    document.getElementsByTagName('head')[0].appendChild(script);
  }

  window.onload = function() {
    loadScript('/js/bundle.js?235683', function() {
      // load success
    });
  }
</script>

</body>
</html>
